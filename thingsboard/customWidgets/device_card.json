{
  "fqn": "device_card",
  "name": "Device Card",
  "deprecated": false,
  "image": "tb-image:ZGV2aWNlQ2FyZC13aWRnZXQucG5n:ZGV2aWNlQ2FyZC13aWRnZXQucG5n;data:image/png;base64,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",
  "description": null,
  "descriptor": {
    "type": "rpc",
    "sizeX": 5.5,
    "sizeY": 6,
    "resources": [
      {
        "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      },
      {
        "url": "https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js",
        "isModule": false
      },
      {
        "url": "https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"
      }
    ],
    "templateHtml": "<div fxFlex fxLayout=\"column\" fxLayoutAlign=\"center center\" class=\"card2\">\r\n    <div fxFlex fxLayoutAlign=\"space-between start\"  class=\"main\">\r\n        <div class=\"image-container\">\r\n            <img class=\"image\" [src]=\"imageName\" />\r\n        </div>\r\n        <div class=\"icons\" fxLayout=\"column\" fxLayoutAlign=\"start end\">\r\n            <div class=\"form-check form-switch switch\">\r\n                <input class=\"form-check-input\"\r\n                    type=\"checkbox\" role=\"switch\"\r\n                    id=\"flexSwitchCheckDefault\"\r\n                    [checked]=\"checkState\"\r\n                    (change)=\"gpioToggleChange($event)\">\r\n            </div>\r\n            <div class=\"wifi-icon\" [ngClass]=\"{'active-wifi': statusDevice}\" matTooltip={{wifiStatus}} matTooltipPosition=\"above\">\r\n                <i class=\"bi bi-wifi\"></i>\r\n            </div>\r\n            <div class=\"power-icon\" [ngClass]=\"{'active-power': statusDevice}\">\r\n                <i class=\"bi bi-plug-fill\"></i>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div fxFlex fxLayout=\"column\" fxLayoutAlign=\"start start\" class=\"footer\">\r\n        <h2 class=\"deviceTitle\">{{deviceTitle}}</h2>\r\n        <h3 class=\"deviceSubtitle\">{{deviceSubtitle}}</h3>\r\n    </div>\r\n</div>",
    "templateCss": ".card2 {\r\n    /*border: solid red 1px;*/\r\n    margin: auto;\r\n}\r\n\r\n.main {\r\n    width: 100%;\r\n    padding-top: 20px;\r\n    padding-left: 10px;\r\n    padding-right: 10px;\r\n}\r\n\r\n.icons{\r\n    gap: 10px;\r\n}\r\n\r\n.switch{\r\n    display: flex;\r\n    justify-content: end;\r\n    font-size: 1.5rem;\r\n}\r\n\r\n.image {\r\n  max-width: 100%;\r\n  height: 150px;\r\n  object-fit: contain;\r\n}\r\n\r\n.image-container{\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n.footer {\r\n    padding-left:10px;\r\n    width: 100%;\r\n    /*border: solid 1px blue;*/\r\n}\r\n\r\n.footer h3 {\r\n    font-size: 0.8rem;\r\n    padding: 0;\r\n    margin: 0;\r\n    color:#B6C3DB;\r\n}\r\n\r\n.footer h2 {\r\n    line-height: normal;\r\n    font-size: 1.2rem;\r\n    padding: 0;\r\n    margin: 0;\r\n    font-weight: 500;\r\n}\r\n\r\n\r\n.wifi-icon {\r\n    display: flex;\r\n    justify-content: center;\r\n    width: 30px;\r\n    height: 30px;\r\n    border-radius: 50%;\r\n    background-size: cover;\r\n    background-color: #F6F7F9;\r\n    color:#B4C2DD;\r\n}\r\n\r\n.power-icon {\r\n    display: flex;\r\n    justify-content: center;\r\n    width: 30px;\r\n    height: 30px;\r\n    border-radius: 50%;\r\n    background-size: cover;\r\n    background-color: #F6F7F9;\r\n    color:#B4C2DD;\r\n}\r\n\r\n.active-power{\r\n    background-color: #EFF8F3;\r\n    color: #5CC489;\r\n}\r\n\r\n.active-wifi{\r\n    background-color: #ECF2FE;\r\n    color: #5492FE;\r\n}\r\n",
    "controllerScript": "self.onInit = function() {\r\n    \r\n    self.ctx.$scope.data = self.ctx.defaultSubscription.data;\r\n    self.ctx.$scope.deviceTitle = self.ctx.settings.deviceTitle;\r\n    self.ctx.$scope.deviceSubtitle = self.ctx.settings.deviceSubtitle;\r\n    self.ctx.$scope.imageName = self.ctx.settings.imageName;\r\n    self.ctx.$scope.deviceName = self.ctx.settings.deviceName;\r\n    self.ctx.$scope.entityId = self.ctx.settings.entityId;\r\n    self.ctx.$scope.deviceStatus1 = false;\r\n    self.ctx.$scope.deviceStatus2 = false;\r\n    self.ctx.$scope.deviceStatus3 = false;\r\n    self.ctx.$scope.deviceStatus4 = false;\r\n    self.ctx.$scope.rpcMethod = self.ctx.settings.rpcMethod;\r\n    self.ctx.$scope.rpcType = self.ctx.settings.rpcType;\r\n    self.ctx.$scope.timeout = self.ctx.settings.requestTimeout;\r\n    self.ctx.$scope.statusDevice = false;\r\n    self.ctx.$scope.ssid = false;\r\n    self.ctx.$scope.rssi = false;\r\n    self.ctx.$scope.checkState = false;\r\n    self.ctx.$scope.wifiStatus =`ssid ${self.ctx.$scope.ssid} rssi ${self.ctx.$scope.rssi}`;\r\n\r\n    if (!self.ctx.$scope.deviceTitle) {self.ctx.$scope.deviceTitle = \"Device Title\"}\r\n    if (!self.ctx.$scope.deviceSubtitle) {self.ctx.$scope.deviceSubtitle =\"Device Subtitle\"}\r\n    if (!self.ctx.$scope.imageName) {self.ctx.$scope.imageName = \"/api/images/public/4dkyQ3xhwWMgDUYcZSI71QNxndRSvaRt\"}\r\n    if (!self.ctx.$scope.entityId) {self.ctx.$scope.entityId = \"cde78cc0-2398-11ef-b19f-cdc6a3f105ff\"}\r\n    if (!self.ctx.$scope.deviceName) {self.ctx.$scope.deviceName = \"device1\"}\r\n    if (!self.ctx.$scope.rpcMethod) {self.ctx.$scope.rpcMethod = \"set_switch\"}\r\n    if (!self.ctx.$scope.rpcType) {self.ctx.$scope.rpcType = \"oneway\"}\r\n    if (!self.ctx.$scope.timeout) {self.ctx.$scope.timeout = 1000}\r\n\r\n    self.ctx.$scope.sendCommand = function(status) {\r\n        \r\n        console.log('rpcMethod', self.ctx.$scope.rpcMethod);\r\n        console.log('timeout', self.ctx.$scope.timeout);\r\n        var rpcParams = {\r\n            switch: status,\r\n            value: \"0\"\r\n        };\r\n\r\n        var oneWayElseTwoWay = false;\r\n\r\n        if (self.ctx.$scope.rpcType === \"oneway\") {\r\n            oneWayElseTwoWay = true;\r\n        } else {\r\n            oneWayElseTwoWay = false;\r\n        }\r\n\r\n        var commandObservable;\r\n        if (oneWayElseTwoWay) {\r\n            console.log(\"oneway\");\r\n            console.log(JSON.stringify(rpcParams));\r\n            commandObservable = self.ctx.controlApi\r\n                .sendOneWayCommand(self.ctx.$scope\r\n                    .rpcMethod, rpcParams, self.ctx\r\n                    .$scope.timeout);\r\n        } else {\r\n            console.log(rpcParams);\r\n            console.log(\"twoway\");\r\n            console.log(JSON.parse(rpcParams));\r\n            commandObservable = self.ctx.controlApi\r\n                .sendTwoWayCommand(self.ctx.$scope\r\n                    .rpcMethod, JSON\r\n                    .parse(rpcParams), self.ctx\r\n                    .$scope.timeout);\r\n        }\r\n        commandObservable.subscribe(\r\n            function(response) {\r\n                if (oneWayElseTwoWay) {\r\n                    self.ctx.$scope\r\n                        .rpcCommandResponse =\r\n                        \"Command was successfully received by device.<br> No response body because of one way command mode.\";\r\n                } else {\r\n                    self.ctx.$scope\r\n                        .rpcCommandResponse =\r\n                        \"Response from device:<br>\";\r\n                    self.ctx.$scope\r\n                        .rpcCommandResponse +=\r\n                        JSON.stringify(response,\r\n                            undefined, 2);\r\n                }\r\n                self.ctx.detectChanges();\r\n            },\r\n            function(rejection) {\r\n                self.ctx.$scope\r\n                    .rpcCommandResponse =\r\n                    \"Failed to send command to the device:<br>\";\r\n                self.ctx.$scope\r\n                    .rpcCommandResponse +=\r\n                    \"Status: \" + rejection\r\n                    .status + \"<br>\";\r\n                self.ctx.$scope\r\n                    .rpcCommandResponse +=\r\n                    \"Status text: '\" + rejection\r\n                    .statusText + \"'\";\r\n                self.ctx.detectChanges();\r\n            }\r\n        );\r\n    };\r\n\r\n    self.ctx.$scope.gpioToggleChange = function(\r\n        $event) {\r\n        // self.ctx.$scope.sendCommand($event.target\r\n        //     .checked);\r\n        \r\n        // Mapa de dispositivos y sus claves de estado\r\n            const deviceStateMap = {\r\n                'device1': 'deviceState1',\r\n                'device2': 'deviceState2',\r\n                'device3': 'deviceState3',\r\n                'device4': 'deviceState4'\r\n            };\r\n            \r\n            // Obtiene el nombre del dispositivo actual\r\n            const deviceName = self.ctx.$scope.deviceName;\r\n            \r\n            // Verifica si el nombre del dispositivo estÃ¡ en el mapa\r\n            if (deviceStateMap.hasOwnProperty(deviceName)) {\r\n                const stateKey = deviceStateMap[deviceName];\r\n            \r\n                self.ctx.attributeService.saveEntityAttributes(\r\n                    { entityType: 'DEVICE', id: self.ctx.$scope.entityId },\r\n                    'SHARED_SCOPE', [{\r\n                        key: stateKey,\r\n                        value: $event.target.checked\r\n                    }]\r\n                ).subscribe((res) => {\r\n                    console.log(res);\r\n                });\r\n            }\r\n        \r\n    };\r\n\r\n    const datasources = [{\r\n        type: \"entity\",\r\n        dataKeys: [{\r\n            decimals: 0,\r\n            label: \"\",\r\n            name: \"connectivity\",\r\n            settings: {},\r\n            type: \"attribute\"\r\n        },{\r\n            decimals: 0,\r\n            label: \"\",\r\n            name: \"ssid\",\r\n            settings: {},\r\n            type: \"attribute\"\r\n        },{\r\n            decimals: 0,\r\n            label: \"\",\r\n            name: \"rssi\",\r\n            settings: {},\r\n            type: \"attribute\"\r\n        },{\r\n            decimals: 0,\r\n            label: \"\",\r\n            name: \"deviceState1\",\r\n            settings: {},\r\n            type: \"attribute\"\r\n        },{\r\n            decimals: 0,\r\n            label: \"\",\r\n            name: \"deviceState2\",\r\n            settings: {},\r\n            type: \"attribute\"\r\n        },{\r\n            decimals: 0,\r\n            label: \"\",\r\n            name: \"deviceState3\",\r\n            settings: {},\r\n            type: \"attribute\"\r\n        },{\r\n            decimals: 0,\r\n            label: \"\",\r\n            name: \"deviceState4\",\r\n            settings: {},\r\n            type: \"attribute\"\r\n        }],\r\n        entityFilter: {\r\n            type: \"singleEntity\",\r\n            singleEntity: {\r\n                id: self.ctx.$scope.entityId,\r\n                entityType: \"DEVICE\"\r\n            }\r\n        }\r\n    }];\r\n\r\n    const subscriptionOptions = {\r\n        type: 'latest',\r\n        datasources: datasources,\r\n        callbacks: {\r\n            onDataUpdated: () => {\r\n                self.onDataUpdated();\r\n            }\r\n        }\r\n    };\r\n\r\n    self.ctx.subscriptionApi.createSubscription(\r\n        subscriptionOptions, true).subscribe(\r\n        (subscription) => {\r\n            self.ctx.defaultSubscription = subscription;\r\n            self.ctx.data = subscription.data;\r\n            self.ctx.datasources = subscription.datasources;\r\n        }\r\n    );\r\n    \r\n    self.ctx.$scope.data = self.ctx.data;\r\n};\r\n\r\nself.onDataUpdated = function() {\r\n    // console.log('onDataUpdated');\r\n    // console.log('data', self.ctx.data);\r\n\r\n    try {\r\n        const statusDevice = JSON.parse(self.ctx.data[0].data[0][1]);\r\n        self.ctx.$scope.statusDevice = statusDevice;\r\n    } catch (e) {\r\n        console.error('Error parsing statusDevice', e);\r\n    }\r\n\r\n    try {\r\n        const ssid = self.ctx.data[1].data[0][1];\r\n        self.ctx.$scope.ssid = ssid;\r\n    } catch (e) {\r\n        console.error('Error parsing ssid', e);\r\n    }\r\n\r\n    try {\r\n        const rssi = JSON.parse(self.ctx.data[2].data[0][1]);\r\n        self.ctx.$scope.rssi = rssi;\r\n    } catch (e) {\r\n        console.error('Error parsing rssi', e);\r\n    }\r\n\r\n    try {\r\n        const device1 = JSON.parse(self.ctx.data[3].data[0][1]);\r\n        self.ctx.$scope.deviceStatus1 = device1;\r\n    } catch (e) {\r\n        console.error('Error parsing device1', e);\r\n    }\r\n    \r\n    try {\r\n        const device2 = JSON.parse(self.ctx.data[4].data[0][1]);\r\n        self.ctx.$scope.deviceStatus2 = device2;\r\n    } catch (e) {\r\n        console.error('Error parsing device2', e);\r\n    }\r\n    \r\n    try {\r\n        const device3 = JSON.parse(self.ctx.data[5].data[0][1]);\r\n        self.ctx.$scope.deviceStatus3 = device3;\r\n    } catch (e) {\r\n        console.error('Error parsing device3', e);\r\n    }\r\n    \r\n    try {\r\n        const device4 = JSON.parse(self.ctx.data[6].data[0][1]);\r\n        self.ctx.$scope.deviceStatus4 = device4;\r\n    } catch (e) {\r\n        console.error('Error parsing device4', e);\r\n    }\r\n    \r\n    if (self.ctx.$scope.deviceName === 'device1'){\r\n        console.log('device1')\r\n        self.ctx.$scope.checkState = self.ctx.$scope.deviceStatus1;\r\n    }\r\n    \r\n    if (self.ctx.$scope.deviceName === 'device2'){\r\n        console.log('device2')\r\n        self.ctx.$scope.checkState = self.ctx.$scope.deviceStatus2;\r\n    }\r\n    \r\n    if (self.ctx.$scope.deviceName === 'device3'){\r\n        console.log('device3')\r\n        self.ctx.$scope.checkState = self.ctx.$scope.deviceStatus3;\r\n    }\r\n    \r\n    if (self.ctx.$scope.deviceName === 'device4'){\r\n        console.log('device4')\r\n        self.ctx.$scope.checkState = self.ctx.$scope.deviceStatus4;\r\n    };\r\n    \r\n    self.ctx.$scope.wifiStatus =`SSID: ${self.ctx.$scope.ssid} / RSSI: ${self.ctx.$scope.rssi}`;\r\n    \r\n    console.log(self.ctx.$scope.data)\r\n    self.ctx.detectChanges();\r\n};\r\n",
    "settingsSchema": "{\r\n    \"schema\": {\r\n        \"type\": \"object\",\r\n        \"title\": \"Settings\",\r\n        \"properties\": {\r\n            \"deviceTitle\": {\r\n                \"title\": \"Device Title\",\r\n                \"type\": \"string\",\r\n                \"default\": \"Device Title\"\r\n            },\r\n            \"deviceSubtitle\": {\r\n                \"title\": \"Device Subtitle\",\r\n                \"type\": \"string\",\r\n                \"default\": \"Device Subtitle\"\r\n            },\r\n            \"imageName\": {\r\n                \"title\": \"image Name\",\r\n                \"type\": \"string\",\r\n                \"default\": \"imageName\"\r\n            },\r\n            \"deviceName\": {\r\n                \"title\": \"Device Name\",\r\n                \"type\": \"string\",\r\n                \"default\": \"DeviceName\"\r\n            },\r\n            \"entityId\": {\r\n                \"title\": \"Entity Id\",\r\n                \"type\": \"string\",\r\n                \"default\": \"entityId\"\r\n            },\r\n            \"rpcMethod\": {\r\n                \"title\": \"Rpc Method\",\r\n                \"type\": \"string\",\r\n                \"default\": \"rpcMethod\"\r\n            },\r\n            \"rpcType\": {\r\n                \"title\": \"Rpc Type\",\r\n                \"type\": \"string\",\r\n                \"enum\": [\r\n                    \"oneway\",\r\n                    \"twoway\"\r\n                ]\r\n            },\r\n            \"requestTimeout\": {\r\n                \"title\": \"Request Timeout\",\r\n                \"type\": \"number\",\r\n                \"default\": \"0\"\r\n            },\r\n            \"required\": []\r\n        },\r\n        \"form\": [\r\n            \"deviceTitle\",\r\n            \"deviceSubtitle\",\r\n            \"imageName\",\r\n            \"deviceName\",\r\n            \"rpcMethod\",\r\n            \"rpcType\",\r\n            \"requestTimeout\",\r\n            \"entityId\"\r\n        ]\r\n    }\r\n}",
    "dataKeySettingsSchema": "",
    "settingsDirective": "",
    "defaultConfig": "{\"targetDeviceAliases\":[],\"showTitle\":false,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"0px\",\"settings\":{\"requestTimeout\":500,\"deviceTitle\":\"Device Title\",\"deviceSubtitle\":\"Device Subtitle\",\"imageName\":\"imageName\",\"rpcMethod\":\"rpcMethod\",\"rpcType\":\"oneway\"},\"title\":\"Device Card\",\"dropShadow\":false,\"enableFullscreen\":false,\"enableDataExport\":true,\"widgetStyle\":{},\"widgetCss\":\"\",\"pageSize\":1024,\"noDataDisplayMessage\":\"\"}"
  },
  "tags": null
}